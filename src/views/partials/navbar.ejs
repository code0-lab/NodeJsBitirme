<nav class="navbar">
  <div class="navbar-brand">
    <a href="/" class="rune" aria-label="Yggdrasil">
      &#x16C9;&#x16B7;&#x16B7;&#x16DE;&#x16B1;&#x16A8;&#x16BA;&#x16C9;&#x16DA;
    </a>
  </div>
  <ul class="navbar-links">
    <li><a href="/">Ana Sayfa</a></li>
    <li><a href="/auth/register">Kayıt Ol</a></li>
    <li><a href="/api-docs">API Docs</a></li>
    <!-- Arama aç/kapat butonu -->
    <li>
      <button class="navbar-icon search-toggle" aria-label="Ara">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
          <circle cx="11" cy="11" r="7" stroke="currentColor" stroke-width="2"></circle>
          <line x1="16.5" y1="16.5" x2="21" y2="21" stroke="currentColor" stroke-width="2" stroke-linecap="round"></line>
        </svg>
      </button>
    </li>
    <!-- Dark mode toggle -->
    <li>
      <button class="theme-toggle" id="themeToggle" aria-label="Tema değiştir">
        <svg width="28" height="28" viewBox="0 0 48 24" fill="none" aria-hidden="true">
          <!-- Island / kara parçası -->
          <ellipse class="island" cx="24" cy="18" rx="16" ry="4" fill="currentColor"></ellipse>
          <!-- Sun -->
          <g class="sun" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="8" r="4" fill="none"></circle>
            <line x1="12" y1="1" x2="12" y2="4"></line>
            <line x1="12" y1="12" x2="12" y2="15"></line>
            <line x1="5" y1="8" x2="8" y2="8"></line>
            <line x1="16" y1="8" x2="19" y2="8"></line>
            <line x1="7" y1="3" x2="9" y2="5"></line>
            <line x1="15" y1="11" x2="17" y2="13"></line>
            <line x1="7" y1="13" x2="9" y2="11"></line>
            <line x1="15" y1="5" x2="17" y2="3"></line>
          </g>
          <!-- Moon -->
          <path class="moon" d="M34 6c-3.5 0-6.5 3-6.5 6.5s3 6.5 6.5 6.5c-3-1.2-5.3-4.1-5.3-6.5s2.3-5.3 5.3-6.5z" fill="currentColor"></path>
        </svg>
      </button>
    </li>
  </ul>
</nav>
<!-- Arama paneli ve overlay -->
<div id="searchOverlay" class="search-overlay" hidden></div>
<div id="searchPanel" class="search-panel" role="dialog" aria-label="Site içi arama" aria-modal="true" hidden>
  <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
    <circle cx="11" cy="11" r="7" stroke="currentColor" stroke-width="2"></circle>
    <line x1="16.5" y1="16.5" x2="21" y2="21" stroke="currentColor" stroke-width="2" stroke-linecap="round"></line>
  </svg>
  <input id="searchInput" type="text" placeholder="Ara: başlık, yazar, etiket..." />
  <button id="searchClose" type="button" class="btn outline">Kapat</button>
</div>

<script>
  (function () {
    const toggleSearchBtn = document.querySelector('.search-toggle');
    const panel = document.getElementById('searchPanel');
    const overlay = document.getElementById('searchOverlay');
    const input = document.getElementById('searchInput');
    const closeBtn = document.getElementById('searchClose');

    function openPanel() {
      panel.hidden = false;
      overlay.hidden = false;
      panel.classList.add('open');
      overlay.classList.add('open');
      document.body.style.overflow = 'hidden';
      setTimeout(() => input && input.focus(), 50);
    }
    function closePanel() {
      panel.classList.remove('open');
      overlay.classList.remove('open');
      document.body.style.overflow = '';
      input.value = '';
      setTimeout(() => { panel.hidden = true; overlay.hidden = true; }, 200);
    }

    toggleSearchBtn?.addEventListener('click', openPanel);
    overlay?.addEventListener('click', closePanel);
    closeBtn?.addEventListener('click', closePanel);
    document.addEventListener('keydown', (e) => { if (e.key === 'Escape') closePanel(); });

    // Tema toggle
    const themeBtn = document.getElementById('themeToggle');
    const KEY = 'theme';
    function applyTheme(mode) {
      document.body.classList.toggle('theme-dark', mode === 'dark');
    }
    const saved = localStorage.getItem(KEY) || (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
    applyTheme(saved);

    themeBtn?.addEventListener('click', () => {
      const next = document.body.classList.contains('theme-dark') ? 'light' : 'dark';
      applyTheme(next);
      localStorage.setItem(KEY, next);
    });
  })();
</script>